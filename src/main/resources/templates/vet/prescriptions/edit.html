<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Edit Prescription</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body style="margin:0; padding:0; background:#f8f9fa;">
    <div style="display:flex; min-height:100vh;">
        <nav style="width:240px; background:#2c3e50; color:#fff; display:flex; flex-direction:column; padding:2rem 1rem 1rem 1rem; min-height:100vh;">
            <div>
                <h2 style="color:#fff; font-size:1.5rem; font-weight:700; margin-bottom:2rem;">Veterinarian</h2>
                <ul style="list-style:none; padding:0; margin:0;">
                    <li style="margin-bottom:1.2rem;"><a th:href="@{/dashboard/vet}" style="color:#fff; text-decoration:none; font-weight:500; display:block; padding:0.5rem 1rem; border-radius:6px; transition:background 0.2s;">Dashboard</a></li>
                    <li style="margin-bottom:1.2rem;"><a th:href="@{/vet/appointments}" style="color:#fff; text-decoration:none; font-weight:500; display:block; padding:0.5rem 1rem; border-radius:6px; transition:background 0.2s;">Appointments</a></li>
                    <li style="margin-bottom:1.2rem;"><a th:href="@{/vet/prescriptions}" style="color:#fff; text-decoration:none; font-weight:500; display:block; padding:0.5rem 1rem; border-radius:6px; transition:background 0.2s;">Prescriptions</a></li>
                    <li style="margin-bottom:1.2rem;"><a th:href="@{/vet/messages}" style="color:#fff; text-decoration:none; font-weight:500; display:block; padding:0.5rem 1rem; border-radius:6px; transition:background 0.2s;">Messages</a></li>
                    <li style="margin-bottom:1.2rem;">
                        <form th:action="@{/logout}" method="post" style="margin:0;">
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                            <button type="submit" style="width:100%; background:none; border:none; color:#fff; font-size:1rem; font-weight:500; text-align:left; padding:0.5rem 1rem; border-radius:6px; transition:background 0.2s;">Logout</button>
                        </form>
                    </li>
                </ul>
            </div>
        </nav>
        <main style="flex:1; padding:2rem; min-height:100vh; background:#f8f9fa;">
            <div class="container mt-4">
                <div class="card">
                    <div class="card-header">
                        <h2>Edit Prescription</h2>
                    </div>
                    <div class="card-body">
                        <div th:if="${error}" class="alert alert-danger" role="alert">
                            <span th:text="${error}"></span>
                        </div>

                        <form th:action="@{/vet/prescriptions/{id}/edit(id=${prescription.id})}" 
                              th:object="${prescription}" 
                              method="post"
                              class="needs-validation" 
                              novalidate>
                            
                            <!-- Symptoms -->
                            <div class="form-group mb-3">
                                <label for="symptoms">Symptoms</label>
                                <textarea class="form-control" id="symptoms" th:field="*{symptoms}" rows="3" required></textarea>
                                <div class="invalid-feedback" th:if="${#fields.hasErrors('symptoms')}" th:errors="*{symptoms}"></div>
                            </div>

                            <!-- Diagnosis -->
                            <div class="form-group mb-3">
                                <label for="diagnosis">Diagnosis</label>
                                <textarea class="form-control" id="diagnosis" th:field="*{diagnosis}" rows="3" required></textarea>
                                <div class="invalid-feedback" th:if="${#fields.hasErrors('diagnosis')}" th:errors="*{diagnosis}"></div>
                            </div>

                            <!-- Medications -->
                            <div class="form-group mb-3">
                                <label for="medications">Medications</label>
                                <textarea class="form-control" id="medications" th:field="*{medications}" rows="3" required></textarea>
                                <div class="invalid-feedback" th:if="${#fields.hasErrors('medications')}" th:errors="*{medications}"></div>
                            </div>

                            <!-- Notes -->
                            <div class="form-group mb-3">
                                <label for="notes">Additional Notes</label>
                                <textarea class="form-control" id="notes" th:field="*{notes}" rows="3"></textarea>
                                <div class="invalid-feedback" th:if="${#fields.hasErrors('notes')}" th:errors="*{notes}"></div>
                            </div>

                            <div class="form-group">
                                <button type="submit" class="btn btn-primary">Update Prescription</button>
                                <a th:href="@{/vet/prescriptions}" class="btn btn-secondary">Cancel</a>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Form validation
        (function () {
            'use strict'
            var forms = document.querySelectorAll('.needs-validation')
            Array.prototype.slice.call(forms).forEach(function (form) {
                form.addEventListener('submit', function (event) {
                    if (!form.checkValidity()) {
                        event.preventDefault()
                        event.stopPropagation()
                    }
                    form.classList.add('was-validated')
                }, false)
            })
        })()
    </script>
    <script th:src="@{/js/chatbot.js}"></script>
</body>
</html> 